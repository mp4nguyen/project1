"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require("angular2/core");
var common_1 = require('angular2/common');
var dialog_component_1 = require("../../shared/components/dialog/dialog.component");
var logging_service_1 = require('../../shared/services/logging.service');
var doctor_model_1 = require('../models/doctor.model');
var input_component_1 = require('../../shared/components/input/input.component');
var companies_services_1 = require('../services/companies.services');
var SelectDoctorComponent = (function () {
    function SelectDoctorComponent(_log, _companyServices) {
        var _this = this;
        this._log = _log;
        this._companyServices = _companyServices;
        this.doctor = new doctor_model_1.Doctor(null);
        this.components = new Array();
        this.doctors = [];
        this.people = [];
        this.isNew = true;
        this.doctorIdControl = new common_1.Control();
        this.bookingTypeNameControl = new common_1.Control();
        this.isenableControl = new common_1.Control();
        this.components.push({ control: this.doctorIdControl, type: 'option', title: 'Doctor', placeholder: 'Booking Type', isRequired: true, requiredMsg: 'Booking type is required', labelColumnClass: 'col-md-3 control-label', inputColumnClass: 'col-md-9', values: this.doctors, displayProperty: 'bookingTypeName', returnProperty: 'doctorId' });
        this.components.push({ control: this.isenableControl, type: 'boolean', title: 'Enable', placeholder: 'Clinic Name', isRequired: true, requiredMsg: 'Clinic name is required', labelColumnClass: 'col-md-3 control-label', inputColumnClass: 'col-md-9' });
        this.myForm = new common_1.ControlGroup({
            doctorId: this.doctorIdControl,
            isenable: this.isenableControl
        });
        this.myForm.valueChanges.subscribe(function (data) { _this._log.log('booking type form = ', JSON.stringify(_this.myForm.value)); });
    }
    SelectDoctorComponent.prototype.ngOnInit = function () {
    };
    SelectDoctorComponent.prototype.openDialog = function (doctor) {
        var _this = this;
        this.doctors = this._companyServices.getCanselectingDoctors();
        this.people = [];
        for (var _i = 0, _a = this.doctors; _i < _a.length; _i++) {
            var dt = _a[_i];
            dt.person.doctorId = dt.doctorId;
            dt.person.doctorName = dt.person.firstName + ' ' + dt.person.lastName;
            this.people.push(dt.person);
        }
        this._log.log(' get doctors be able to select = ', this.doctors, this.people);
        this.components[0] = { control: this.doctorIdControl, type: 'option', title: 'Doctor', placeholder: 'Booking Type', isRequired: true, requiredMsg: 'Booking type is required', labelColumnClass: 'col-md-3 control-label', inputColumnClass: 'col-md-9', values: this.people, displayProperty: 'doctorName', returnProperty: 'doctorId' };
        if (doctor) {
            this.isNew = false;
            this.doctor = doctor;
            this.updateView();
        }
        else {
            this.isNew = true;
            this.doctor = new doctor_model_1.Doctor(null);
            this.updateView();
        }
        this.myDialog.activate().subscribe(function (code) { _this._log.log('dialog return code =', code); }, function (err) { _this._log.log('dialog return err =', err); }, function () { _this._log.log('dialog completed'); });
    };
    SelectDoctorComponent.prototype.updateView = function () {
        this.doctorIdControl.updateValue(this.doctor.doctorId);
        this.isenableControl.updateValue(this.doctor.isenable);
    };
    SelectDoctorComponent.prototype.remove = function () {
        this._companyServices.clinicRemoveDoctor(this.doctorIdControl.value);
        this.myDialog.ok(null);
    };
    SelectDoctorComponent.prototype.add = function () {
        this._companyServices.clinicAddDoctor(this.doctorIdControl.value);
        this.myDialog.ok(null);
    };
    __decorate([
        core_1.ViewChild('myDialog'), 
        __metadata('design:type', dialog_component_1.DialogComponent)
    ], SelectDoctorComponent.prototype, "myDialog", void 0);
    SelectDoctorComponent = __decorate([
        core_1.Component({
            selector: 'select-doctor',
            directives: [dialog_component_1.DialogComponent, input_component_1.InputComponent],
            template: "\n    <my-dialog #myDialog>\n        <div class=\"modal-header\">\n            <button type=\"button\" (click)=\"myDialog.close()\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\"></button>\n            <h4 class=\"modal-title\">Booking Type</h4>\n        </div>\n        <div class=\"modal-body\"> \n             <div class=\"portlet-body form\">\n                    <form role=\"form\">\n                        <div class=\"form-body\">\n                            <div class=\"row\">\n                                <div class=\"col-md-12\">\n                                    \n                                    <div *ngIf=\"isNew\"><my-input [isSubmitted]=\"isSubmitted\" [options]=\"components[0]\"></my-input></div>                                    \n                                </div>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n        </div>\n        <div class=\"modal-footer\">\n            <button (click)=\"myDialog.cancel()\" type=\"button\" class=\"btn dark btn-outline\" data-dismiss=\"modal\">Close</button>\n            <button *ngIf=\"!isNew\" (click)=\"remove()\" type=\"button\" class=\"btn red\">Remove</button>\n            <button *ngIf=\"isNew\" (click)=\"add()\" type=\"button\" class=\"btn green\">Add</button>\n        </div>\n    </my-dialog>    \n    "
        }), 
        __metadata('design:paramtypes', [logging_service_1.MyLogger, companies_services_1.CompaniesService])
    ], SelectDoctorComponent);
    return SelectDoctorComponent;
}());
exports.SelectDoctorComponent = SelectDoctorComponent;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBhbmllcy9jb21wb25lbnRzL3NlbGVjdGRvY3RvcnMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxxQkFBZ0QsZUFBZSxDQUFDLENBQUE7QUFDaEUsdUJBQTBFLGlCQUFpQixDQUFDLENBQUE7QUFFNUYsaUNBQThCLGlEQUFpRCxDQUFDLENBQUE7QUFDaEYsZ0NBQXVCLHVDQUF1QyxDQUFDLENBQUE7QUFDL0QsNkJBQXFCLHdCQUF3QixDQUFDLENBQUE7QUFFOUMsZ0NBQThCLCtDQUErQyxDQUFDLENBQUE7QUFDOUUsbUNBQStCLGdDQUFnQyxDQUFDLENBQUE7QUFtQ2hFO0lBZ0JJLCtCQUFvQixJQUFhLEVBQVMsZ0JBQWtDO1FBaEJoRixpQkF1RkM7UUF2RXVCLFNBQUksR0FBSixJQUFJLENBQVM7UUFBUyxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBWnBFLFdBQU0sR0FBVyxJQUFJLHFCQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkMsZUFBVSxHQUFrQixJQUFJLEtBQUssRUFBVSxDQUFDO1FBTS9DLFlBQU8sR0FBVyxFQUFFLENBQUM7UUFDckIsV0FBTSxHQUFhLEVBQUUsQ0FBQztRQUN0QixVQUFLLEdBQVksSUFBSSxDQUFDO1FBSzFCLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxnQkFBTyxFQUFFLENBQUM7UUFDckMsSUFBSSxDQUFDLHNCQUFzQixHQUFHLElBQUksZ0JBQU8sRUFBRSxDQUFDO1FBQzVDLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxnQkFBTyxFQUFFLENBQUM7UUFHckMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGVBQWUsRUFBRSxJQUFJLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLGNBQWMsRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFDLFdBQVcsRUFBRSwwQkFBMEIsRUFB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Q0FBQztZQUNQLFFBQVEsRUFBRSxlQUFlO1lBQ3pCLFVBQVUsRUFBRSxDQUFDLGtDQUFlLEVBQUMsZ0NBQWMsQ0FBQztZQUM1QyxRQUFRLEVBQ1IsNDJDQTBCQztTQUNKLENBQUM7OzZCQUFBO0lBeUZGLDRCQUFDO0FBQUQsQ0F2RkEsQUF1RkMsSUFBQTtBQXZGWSw2QkFBcUIsd0JBdUZqQyxDQUFBIiwiZmlsZSI6ImNvbXBhbmllcy9jb21wb25lbnRzL3NlbGVjdGRvY3RvcnMuY29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtPbkluaXQsIENvbXBvbmVudCxWaWV3Q2hpbGQsSW5wdXR9IGZyb20gXCJhbmd1bGFyMi9jb3JlXCI7XG5pbXBvcnQge0NvbnRyb2wsIFZhbGlkYXRvcnMsIE5nRm9ybU1vZGVsLCBDb250cm9sR3JvdXAsRm9ybUJ1aWxkZXJ9ICBmcm9tICdhbmd1bGFyMi9jb21tb24nO1xuXG5pbXBvcnQge0RpYWxvZ0NvbXBvbmVudH0gZnJvbSBcIi4uLy4uL3NoYXJlZC9jb21wb25lbnRzL2RpYWxvZy9kaWFsb2cuY29tcG9uZW50XCI7XG5pbXBvcnQge015TG9nZ2VyfSBmcm9tICcuLi8uLi9zaGFyZWQvc2VydmljZXMvbG9nZ2luZy5zZXJ2aWNlJztcbmltcG9ydCB7RG9jdG9yfSBmcm9tICcuLi9tb2RlbHMvZG9jdG9yLm1vZGVsJztcbmltcG9ydCB7UGVvcGxlfSAgZnJvbSAnLi4vLi4vcGVvcGxlL21vZGVscy9wZW9wbGUubW9kZWwnO1xuaW1wb3J0IHtJbnB1dENvbXBvbmVudH0gIGZyb20gJy4uLy4uL3NoYXJlZC9jb21wb25lbnRzL2lucHV0L2lucHV0LmNvbXBvbmVudCc7XG5pbXBvcnQge0NvbXBhbmllc1NlcnZpY2V9IGZyb20gJy4uL3NlcnZpY2VzL2NvbXBhbmllcy5zZXJ2aWNlcyc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnc2VsZWN0LWRvY3RvcicsXG4gICAgZGlyZWN0aXZlczogW0RpYWxvZ0NvbXBvbmVudCxJbnB1dENvbXBvbmVudF0sXG4gICAgdGVtcGxhdGU6IFxuICAgIGBcbiAgICA8bXktZGlhbG9nICNteURpYWxvZz5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgKGNsaWNrKT1cIm15RGlhbG9nLmNsb3NlKClcIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2J1dHRvbj5cbiAgICAgICAgICAgIDxoNCBjbGFzcz1cIm1vZGFsLXRpdGxlXCI+Qm9va2luZyBUeXBlPC9oND5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+IFxuICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwb3J0bGV0LWJvZHkgZm9ybVwiPlxuICAgICAgICAgICAgICAgICAgICA8Zm9ybSByb2xlPVwiZm9ybVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1tZC0xMlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2ICpuZ0lmPVwiaXNOZXdcIj48bXktaW5wdXQgW2lzU3VibWl0dGVkXT1cImlzU3VibWl0dGVkXCIgW29wdGlvbnNdPVwiY29tcG9uZW50c1swXVwiPjwvbXktaW5wdXQ+PC9kaXY+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj5cbiAgICAgICAgICAgIDxidXR0b24gKGNsaWNrKT1cIm15RGlhbG9nLmNhbmNlbCgpXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGRhcmsgYnRuLW91dGxpbmVcIiBkYXRhLWRpc21pc3M9XCJtb2RhbFwiPkNsb3NlPC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uICpuZ0lmPVwiIWlzTmV3XCIgKGNsaWNrKT1cInJlbW92ZSgpXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIHJlZFwiPlJlbW92ZTwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiAqbmdJZj1cImlzTmV3XCIgKGNsaWNrKT1cImFkZCgpXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGdyZWVuXCI+QWRkPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvbXktZGlhbG9nPiAgICBcbiAgICBgXG59KVxuXG5leHBvcnQgY2xhc3MgU2VsZWN0RG9jdG9yQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAgIEBWaWV3Q2hpbGQoJ215RGlhbG9nJylteURpYWxvZzpEaWFsb2dDb21wb25lbnQ7XG5cbiAgICBwcml2YXRlIGRvY3RvcjogRG9jdG9yID0gbmV3IERvY3RvcihudWxsKTsgICAgXG4gICAgcHVibGljIGNvbXBvbmVudHM6IEFycmF5PE9iamVjdD4gPSBuZXcgQXJyYXk8T2JqZWN0PigpO1xuICAgIHB1YmxpYyBteUZvcm06IENvbnRyb2xHcm91cDtcblxuICAgIHByaXZhdGUgZG9jdG9ySWRDb250cm9sOkNvbnRyb2w7XG4gICAgcHJpdmF0ZSBib29raW5nVHlwZU5hbWVDb250cm9sOkNvbnRyb2w7XG4gICAgcHJpdmF0ZSBpc2VuYWJsZUNvbnRyb2w6Q29udHJvbDsgICBcbiAgICBwcml2YXRlIGRvY3RvcnM6IERvY3RvcltdPVtdO1xuICAgIHByaXZhdGUgcGVvcGxlOiBQZW9wbGVbXSA9IFtdO1xuICAgIHByaXZhdGUgaXNOZXc6IGJvb2xlYW4gPSB0cnVlOyAgICBcbiAgICBwcml2YXRlIHR5cGU6c3RyaW5nOy8vdGhpcyB0eXBlID0gW0RPQ1RPUixDTElOSUNdOyBhcyB0aGlzIGNvbXBvbmVudCBpcyB1c2VkIGluIDIgdGhvc2UgZm9ybXMsIGFuZCBlYWNoIGZvcm0gaGFzIHRoZSBkaWZmZXJlbnQgbWV0aG9kcyBsaWtlIDogbGluayx1bmxpbms7IHNvIG5lZWQgdG8ga25vdyB0aGUgdHlwZSB0byBjYWxsIGNvcnJlY3QgbWV0aG9kcyBcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgX2xvZzpNeUxvZ2dlcixwcml2YXRlIF9jb21wYW55U2VydmljZXM6IENvbXBhbmllc1NlcnZpY2Upe1xuXG4gICAgICAgIHRoaXMuZG9jdG9ySWRDb250cm9sID0gbmV3IENvbnRyb2woKTtcbiAgICAgICAgdGhpcy5ib29raW5nVHlwZU5hbWVDb250cm9sID0gbmV3IENvbnRyb2woKTtcbiAgICAgICAgdGhpcy5pc2VuYWJsZUNvbnRyb2wgPSBuZXcgQ29udHJvbCgpO1xuXG4gICAgICAgIFxuICAgICAgICB0aGlzLmNvbXBvbmVudHMucHVzaCh7Y29udHJvbDogdGhpcy5kb2N0b3JJZENvbnRyb2wsIHR5cGU6J29wdGlvbicsdGl0bGU6ICdEb2N0b3InLCBwbGFjZWhvbGRlcjogJ0Jvb2tpbmcgVHlwZScsIGlzUmVxdWlyZWQ6IHRydWUscmVxdWlyZWRNc2c6ICdCb29raW5nIHR5cGUgaXMgcmVxdWlyZWQnLGxhYmVsQ29sdW1uQ2xhc3M6J2NvbC1tZC0zIGNvbnRyb2wtbGFiZWwnLGlucHV0Q29sdW1uQ2xhc3M6J2NvbC1tZC05Jyx2YWx1ZXM6dGhpcy5kb2N0b3JzLGRpc3BsYXlQcm9wZXJ0eTonYm9va2luZ1R5cGVOYW1lJyxyZXR1cm5Qcm9wZXJ0eTonZG9jdG9ySWQnfSk7XG4gICAgICAgIHRoaXMuY29tcG9uZW50cy5wdXNoKHtjb250cm9sOiB0aGlzLmlzZW5hYmxlQ29udHJvbCwgdHlwZTonYm9vbGVhbicsdGl0bGU6ICdFbmFibGUnLCBwbGFjZWhvbGRlcjogJ0NsaW5pYyBOYW1lJywgaXNSZXF1aXJlZDogdHJ1ZSxyZXF1aXJlZE1zZzogJ0NsaW5pYyBuYW1lIGlzIHJlcXVpcmVkJyxsYWJlbENvbHVtbkNsYXNzOidjb2wtbWQtMyBjb250cm9sLWxhYmVsJyxpbnB1dENvbHVtbkNsYXNzOidjb2wtbWQtOSd9KTtcblxuICAgICAgICB0aGlzLm15Rm9ybSA9IG5ldyBDb250cm9sR3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdG9ySWQ6IHRoaXMuZG9jdG9ySWRDb250cm9sLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNlbmFibGU6IHRoaXMuaXNlbmFibGVDb250cm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7ICAgICAgICBcblxuICAgICAgICB0aGlzLm15Rm9ybS52YWx1ZUNoYW5nZXMuc3Vic2NyaWJlKFxuICAgICAgICAgICAgZGF0YSA9PiB7IHRoaXMuX2xvZy5sb2coJ2Jvb2tpbmcgdHlwZSBmb3JtID0gJywgSlNPTi5zdHJpbmdpZnkodGhpcy5teUZvcm0udmFsdWUpKTt9XG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIG5nT25Jbml0KCl7XG5cblxuXG5cbiAgICB9XG5cbiAgICBvcGVuRGlhbG9nKGRvY3RvcjpEb2N0b3Ipe1xuICAgICAgICBcbiAgICAgICAgdGhpcy5kb2N0b3JzID0gdGhpcy5fY29tcGFueVNlcnZpY2VzLmdldENhbnNlbGVjdGluZ0RvY3RvcnMoKTsgXG4gICAgICAgIHRoaXMucGVvcGxlID0gW107XG4gICAgICAgIGZvcih2YXIgZHQgb2YgdGhpcy5kb2N0b3JzKXtcbiAgICAgICAgICAgIGR0LnBlcnNvbi5kb2N0b3JJZCA9IGR0LmRvY3RvcklkO1xuICAgICAgICAgICAgZHQucGVyc29uLmRvY3Rvck5hbWUgPSBkdC5wZXJzb24uZmlyc3ROYW1lICsgJyAnICsgZHQucGVyc29uLmxhc3ROYW1lO1xuICAgICAgICAgICAgdGhpcy5wZW9wbGUucHVzaChkdC5wZXJzb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xvZy5sb2coJyBnZXQgZG9jdG9ycyBiZSBhYmxlIHRvIHNlbGVjdCA9ICcgLCB0aGlzLmRvY3RvcnMsdGhpcy5wZW9wbGUpO1xuICAgICAgICB0aGlzLmNvbXBvbmVudHNbMF0gPSB7Y29udHJvbDogdGhpcy5kb2N0b3JJZENvbnRyb2wsIHR5cGU6J29wdGlvbicsdGl0bGU6ICdEb2N0b3InLCBwbGFjZWhvbGRlcjogJ0Jvb2tpbmcgVHlwZScsIGlzUmVxdWlyZWQ6IHRydWUscmVxdWlyZWRNc2c6ICdCb29raW5nIHR5cGUgaXMgcmVxdWlyZWQnLGxhYmVsQ29sdW1uQ2xhc3M6J2NvbC1tZC0zIGNvbnRyb2wtbGFiZWwnLGlucHV0Q29sdW1uQ2xhc3M6J2NvbC1tZC05Jyx2YWx1ZXM6dGhpcy5wZW9wbGUsZGlzcGxheVByb3BlcnR5Oidkb2N0b3JOYW1lJyxyZXR1cm5Qcm9wZXJ0eTonZG9jdG9ySWQnfTtcblxuICAgICAgICBpZihkb2N0b3Ipe1xuICAgICAgICAgICAgdGhpcy5pc05ldyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5kb2N0b3IgPSBkb2N0b3I7ICAgIFxuICAgICAgICAgICAgdGhpcy51cGRhdGVWaWV3KCk7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdGhpcy5pc05ldyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRvY3RvciA9IG5ldyBEb2N0b3IobnVsbCk7ICAgIFxuICAgICAgICAgICAgdGhpcy51cGRhdGVWaWV3KCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMubXlEaWFsb2cuYWN0aXZhdGUoKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICBjb2RlID0+IHt0aGlzLl9sb2cubG9nKCdkaWFsb2cgcmV0dXJuIGNvZGUgPScsY29kZSk7fSxcbiAgICAgICAgICAgIGVyciA9PiAge3RoaXMuX2xvZy5sb2coJ2RpYWxvZyByZXR1cm4gZXJyID0nLGVycik7fSxcbiAgICAgICAgICAgICgpID0+ICB7dGhpcy5fbG9nLmxvZygnZGlhbG9nIGNvbXBsZXRlZCcpO30sXG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIHVwZGF0ZVZpZXcoKXtcbiAgICAgICAgdGhpcy5kb2N0b3JJZENvbnRyb2wudXBkYXRlVmFsdWUodGhpcy5kb2N0b3IuZG9jdG9ySWQpO1xuICAgICAgICB0aGlzLmlzZW5hYmxlQ29udHJvbC51cGRhdGVWYWx1ZSh0aGlzLmRvY3Rvci5pc2VuYWJsZSk7XG4gICAgfVxuXG4gICAgcmVtb3ZlKCl7ICAgICAgICBcbiAgICAgICAgdGhpcy5fY29tcGFueVNlcnZpY2VzLmNsaW5pY1JlbW92ZURvY3Rvcih0aGlzLmRvY3RvcklkQ29udHJvbC52YWx1ZSk7XG4gICAgICAgIHRoaXMubXlEaWFsb2cub2sobnVsbCk7XG4gICAgfVxuXG4gICAgYWRkKCl7ICAgICAgICBcbiAgICAgICAgLy90aGlzLl9sb2cubG9nKCdidCA9ICcsdGhpcy5ib29raW5nVHlwZUlkQ29udHJvbC52YWx1ZSk7XG4gICAgICAgIHRoaXMuX2NvbXBhbnlTZXJ2aWNlcy5jbGluaWNBZGREb2N0b3IodGhpcy5kb2N0b3JJZENvbnRyb2wudmFsdWUpO1xuICAgICAgICB0aGlzLm15RGlhbG9nLm9rKG51bGwpO1xuICAgIH1cbn1cbiJdfQ==
